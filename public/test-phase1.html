<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Phase 1 - Services Multi-Utilisateur</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border-left: 4px solid #3498db;
            background: #f8f9fa;
        }
        .test-result {
            margin: 10px 0;
            padding: 8px 12px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .info {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #abd7ff;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .console-output {
            background: #1e1e1e;
            color: #ffffff;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            max-height: 400px;
            overflow-y: auto;
            margin: 15px 0;
        }
        .run-test-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        .run-test-btn:hover {
            background: #0056b3;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-success { background: #28a745; }
        .status-error { background: #dc3545; }
        .status-warning { background: #ffc107; }
        .status-info { background: #17a2b8; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Test Phase 1 - Services Multi-Utilisateur</h1>
        
        <div class="test-section">
            <h3><span class="status-indicator status-info"></span>Statut des tests</h3>
            <div id="test-status">
                <div class="test-result info">Cliquez sur "Ex√©cuter tests" pour commencer...</div>
            </div>
        </div>

        <div class="test-section">
            <h3>Actions de test</h3>
            <button class="run-test-btn" onclick="runPhase1Tests()">
                üöÄ Ex√©cuter tests Phase 1
            </button>
            <button class="run-test-btn" onclick="clearConsole()">
                üßπ Effacer console
            </button>
            <button class="run-test-btn" onclick="testImports()">
                üì¶ Test imports uniquement
            </button>
        </div>

        <div class="test-section">
            <h3>Console de test</h3>
            <div id="console-output" class="console-output">
                Pr√™t pour les tests...<br>
            </div>
        </div>

        <div class="test-section">
            <h3>Informations syst√®me</h3>
            <div id="system-info">
                <div class="test-result info">Chargement des informations syst√®me...</div>
            </div>
        </div>
    </div>

    <script type="module">
        // Variables globales pour la console
        window.consoleOutput = document.getElementById('console-output');
        window.testStatus = document.getElementById('test-status');
        
        // Override console pour capturer les logs
        const originalConsole = { ...console };
        
        function addToConsole(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const colorMap = {
                log: '#ffffff',
                info: '#17a2b8', 
                warn: '#ffc107',
                error: '#dc3545',
                success: '#28a745'
            };
            
            window.consoleOutput.innerHTML += 
                `<span style="color: #666">[${timestamp}]</span> ` +
                `<span style="color: ${colorMap[type] || '#ffffff'}">${message}</span><br>`;
            
            window.consoleOutput.scrollTop = window.consoleOutput.scrollHeight;
        }
        
        console.log = (...args) => {
            originalConsole.log(...args);
            addToConsole(args.join(' '), 'log');
        };
        
        console.info = (...args) => {
            originalConsole.info(...args);
            addToConsole(args.join(' '), 'info');
        };
        
        console.warn = (...args) => {
            originalConsole.warn(...args);
            addToConsole(args.join(' '), 'warn');
        };
        
        console.error = (...args) => {
            originalConsole.error(...args);
            addToConsole(args.join(' '), 'error');
        };

        // Fonctions de test globales
        window.clearConsole = function() {
            window.consoleOutput.innerHTML = 'Console effac√©e...<br>';
        };
        
        window.testImports = async function() {
            try {
                console.log('üîç Test des imports...');
                
                // Test import des services
                const multiUserModule = await import('/src/services/multiUserService.js');
                const displayModule = await import('/src/services/sessionDisplayService.js');
                const migrationModule = await import('/src/services/multiUserMigrationService.js');
                
                console.log('‚úÖ Import multiUserService r√©ussi');
                console.log('‚úÖ Import sessionDisplayService r√©ussi');
                console.log('‚úÖ Import multiUserMigrationService r√©ussi');
                
                updateTestStatus('success', 'Tous les imports fonctionnent correctement');
                
            } catch (error) {
                console.error('‚ùå Erreur import:', error.message);
                updateTestStatus('error', 'Erreur lors des imports: ' + error.message);
            }
        };
        
        window.runPhase1Tests = async function() {
            try {
                updateTestStatus('info', 'Ex√©cution des tests en cours...');
                console.log('üöÄ D√©marrage des tests Phase 1');
                
                // Import du test
                const testModule = await import('/src/tests/phase1-integration-test.js');
                
                console.log('‚úÖ Tests Phase 1 ex√©cut√©s avec succ√®s');
                updateTestStatus('success', 'Phase 1 valid√©e - Tous les services sont op√©rationnels');
                
            } catch (error) {
                console.error('‚ùå Erreur lors des tests:', error.message);
                updateTestStatus('error', 'Erreur Phase 1: ' + error.message);
            }
        };
        
        function updateTestStatus(type, message) {
            const statusMap = {
                success: { class: 'success', icon: '‚úÖ' },
                error: { class: 'error', icon: '‚ùå' },
                warning: { class: 'warning', icon: '‚ö†Ô∏è' },
                info: { class: 'info', icon: '‚ÑπÔ∏è' }
            };
            
            const status = statusMap[type] || statusMap.info;
            window.testStatus.innerHTML = 
                `<div class="test-result ${status.class}">${status.icon} ${message}</div>`;
        }
        
        // Informations syst√®me au chargement
        document.addEventListener('DOMContentLoaded', function() {
            const systemInfo = document.getElementById('system-info');
            systemInfo.innerHTML = `
                <div class="test-result info">üåê User Agent: ${navigator.userAgent.split(' ')[0]}...</div>
                <div class="test-result info">üìç URL: ${window.location.href}</div>
                <div class="test-result info">‚è∞ Charg√© √†: ${new Date().toLocaleString()}</div>
                <div class="test-result info">üîß Support ES Modules: ${typeof import !== 'undefined' ? 'Oui' : 'Non'}</div>
            `;
            
            console.log('üìã Page de test charg√©e et pr√™te');
        });
    </script>
</body>
</html>
