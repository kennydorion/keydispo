<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Simple - Couleurs Utilisateur</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }
        .color-test {
            margin: 10px 0;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #ddd;
        }
        .color-sample {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 15px;
            vertical-align: middle;
            border: 2px solid #fff;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            margin: 10px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>üé® Test Simple - Couleurs Utilisateur</h1>
        <p>Ce test v√©rifie le bon fonctionnement du syst√®me de couleurs.</p>

        <div class="color-test">
            <h3>üìù Logs de Test</h3>
            <div id="log" class="log">
                Initialisation du test...<br>
            </div>
            <button class="btn" onclick="clearLog()">Effacer les logs</button>
        </div>

        <div class="color-test">
            <h3>üîç Tests Automatiques</h3>
            <button class="btn" onclick="testCurrentUserColor()">Tester Couleur Utilisateur Actuel</button>
            <button class="btn" onclick="testRandomUserColors()">Tester Couleurs Al√©atoires</button>
            <button class="btn" onclick="testColorPersistence()">Tester Persistance Couleur</button>
        </div>

        <div class="color-test">
            <h3>üéØ R√©sultats Visuels</h3>
            <div id="colorResults">
                Aucun test ex√©cut√© pour le moment.
            </div>
        </div>

        <div class="color-test">
            <h3>‚öôÔ∏è √âtat Syst√®me</h3>
            <div id="systemStatus">
                V√©rification en cours...
            </div>
        </div>
    </div>

    <script>
        let logElement = document.getElementById('log');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            logElement.innerHTML += `[${timestamp}] ${message}<br>`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }
        
        function clearLog() {
            logElement.innerHTML = '';
        }
        
        function updateSystemStatus() {
            const statusElement = document.getElementById('systemStatus');
            let status = '<ul>';
            
            // V√©rifier la pr√©sence des APIs n√©cessaires
            status += `<li>window.auth: ${typeof window.auth !== 'undefined' ? '‚úÖ' : '‚ùå'}</li>`;
            status += `<li>window.preferences: ${typeof window.preferences !== 'undefined' ? '‚úÖ' : '‚ùå'}</li>`;
            status += `<li>Console disponible: ‚úÖ</li>`;
            status += `<li>Date/heure: ${new Date().toLocaleString()}</li>`;
            
            status += '</ul>';
            statusElement.innerHTML = status;
        }
        
        function testCurrentUserColor() {
            log('üîç Test couleur utilisateur actuel...');
            
            try {
                // Simuler diff√©rents types d'UIDs
                const testUIDs = [
                    'user123',
                    'jean.dupont@example.com',
                    'abc123def456',
                    'test-user-with-long-id'
                ];
                
                testUIDs.forEach(uid => {
                    const color = getUserColorSimulated(uid);
                    log(`üé® UID "${uid}" ‚Üí Couleur: ${color}`);
                    
                    // Afficher visuellement
                    const resultDiv = document.getElementById('colorResults');
                    resultDiv.innerHTML += `
                        <div style="margin: 5px 0;">
                            <span class="color-sample" style="background-color: ${color};"></span>
                            <strong>UID:</strong> ${uid} ‚Üí <strong>Couleur:</strong> ${color}
                        </div>
                    `;
                });
                
                log('‚úÖ Test couleur utilisateur termin√©');
            } catch (error) {
                log(`‚ùå Erreur test couleur: ${error.message}`);
            }
        }
        
        function testRandomUserColors() {
            log('üé≤ Test couleurs utilisateurs al√©atoires...');
            
            for (let i = 0; i < 8; i++) {
                const randomUID = Math.random().toString(36).substring(2, 15);
                const color = getUserColorSimulated(randomUID);
                log(`üé® UID al√©atoire "${randomUID}" ‚Üí ${color}`);
            }
            
            log('‚úÖ Test couleurs al√©atoires termin√©');
        }
        
        function testColorPersistence() {
            log('üíæ Test persistance couleur...');
            log('‚ÑπÔ∏è Ce test n√©cessite une connexion √† l\'application principale');
            log('‚ö†Ô∏è Test simulation - pas de vraie persistance dans cette page');
        }
        
        // Fonction simul√©e pour calculer les couleurs (copie de la logique de l'app)
        function getUserColorSimulated(uid) {
            if (!uid || typeof uid !== 'string') {
                return '#6b7280'; // couleur par d√©faut grise
            }
            
            const colors = [
                '#3b82f6', // blue
                '#ef4444', // red
                '#10b981', // green
                '#f59e0b', // yellow
                '#8b5cf6', // purple
                '#06b6d4', // cyan
                '#f97316', // orange
                '#84cc16', // lime
            ];
            
            // G√©n√©rer un hash simple du UID
            let hash = 0;
            for (let i = 0; i < uid.length; i++) {
                hash = ((hash << 5) - hash + uid.charCodeAt(i)) & 0xffffffff;
            }
            
            return colors[Math.abs(hash) % colors.length];
        }
        
        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            log('üöÄ Test de couleurs initialis√©');
            updateSystemStatus();
            
            // Mettre √† jour le statut toutes les 5 secondes
            setInterval(updateSystemStatus, 5000);
        });
    </script>
</body>
</html>
